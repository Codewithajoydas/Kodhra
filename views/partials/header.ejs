<header style="z-index: 100">
    <span class="logo">
        <div class="backButton" title="Back" onclick="history.back()" tabindex="0" style="display: none;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-arrow-left-icon lucide-arrow-left">
                <path d="m12 19-7-7 7-7" />
                <path d="M19 12H5" />
            </svg>
        </div>
        <div class="sidebar" title="Menu" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-menu-icon lucide-menu" onclick="toggleMenu()">
                <path d="M4 5h16" />
                <path d="M4 12h16" />
                <path d="M4 19h16" />
            </svg>
        </div>
        <span class="lg" style="display: flex; justify-content: center;align-items: center; gap: 10px;" onmouseover="" onclick="window.location.assign('/')">
            <img src="/assets/logo.webp" alt="code snippet manager" />
            <span><span style="white-space: nowrap; font-size: larger;">Kodhra</span>
            </span>
        </span>
    </span>
    <nav>
        <div class="searchResult" data-tooltip="Search">
            <label class="search" for="search" style="cursor: text">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-search-icon lucide-search">
                    <path d="m21 21-4.34-4.34" />
                    <circle cx="11" cy="11" r="8" />
                </svg>

                <input type="search" placeholder="Search Snippets..." id="search" autocomplete="off" />
                <kbd style="
                  background: var(--accent);
                  color: rgb(65, 65, 65);
                  padding: 5px;
                  border-radius: 5px;
                  box-shadow: 2px 2px 0px rgba(128, 128, 128, 0.582);
                ">ctrl+k</kbd>
            </label>
            <div class="results" id="results" style="z-index: 99999999999999999999">
                <ul id="results-list" style="z-index: 99999999999999999999"></ul>
            </div>
        </div>
        <div class="filter" id="filter" data-tooltip="Filter" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-sliders-horizontal-icon lucide-sliders-horizontal">
                <path d="M10 5H3" />
                <path d="M12 19H3" />
                <path d="M14 3v4" />
                <path d="M16 17v4" />
                <path d="M21 12h-9" />
                <path d="M21 19h-5" />
                <path d="M21 5h-7" />
                <path d="M8 10v4" />
                <path d="M8 12H3" />
            </svg>
        </div>
        <div class="notification" data-tooltip="Notifications" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-bell-icon lucide-bell">
                <path d="M10.268 21a2 2 0 0 0 3.464 0" />
                <path
                    d="M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326" />
            </svg>
            <span class="number"></span>
        </div>
        <a class="help" href="/csm-info-page.html" data-tooltip="Help" tabindex="0" aria-label="Know more about Kodhra">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-info-icon lucide-info">
                <circle cx="12" cy="12" r="10" />
                <path d="M12 16v-4" />
                <path d="M12 8h.01" />
            </svg>
        </a>
        <audio src="https://lofi.stream.laut.fm/lofi" id="audio"></audio>
        <div class="music">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="lucide lucide-music-icon lucide-music">
                <path d="M9 18V5l12-2v13" />
                <circle cx="6" cy="18" r="3" />
                <circle cx="18" cy="16" r="3" />
            </svg>
        </div>
        <div class="profile" tabindex="0" onclick="openProfile(event)">
            <img src="<%= image %>" alt="profile image of user" onerror="this.src='https://static.vecteezy.com/system/resources/previews/013/360/247/non_2x/default-avatar-photo-icon-social-media-profile-sign-symbol-vector.jpg'"/>
            <div class="profile-bar">
                <div class="header">
                    <img id="userImage" src="<%= image %>" alt="" onerror="this.src='https://static.vecteezy.com/system/resources/previews/013/360/247/non_2x/default-avatar-photo-icon-social-media-profile-sign-symbol-vector.jpg'" />
                    <div class="name">
                        <span id="userName" style="text-transform: capitalize;">Dummy123</span>
                        <span id="goodName">Good User</span>
                    </div>
                </div>
                <hr class="hr">
                <ul class="menus">
                    <li>
                        <a href="/profile"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-user-icon lucide-user">
                                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" />
                                <circle cx="12" cy="7" r="4" />
                            </svg> My Profile</a>
                    </li>
                    <li>
                        <a href="/card"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-braces-icon lucide-braces">
                                <path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1" />
                                <path d="M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1" />
                            </svg> My Snippets</a>
                    </li>
                    <li>
                        <a href="/fav"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-star-icon lucide-star">
                                <path
                                    d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z" />
                            </svg> Favorites Cards</a>
                    </li>
                    <li>
                        <a href="/pin"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-pin-icon lucide-pin">
                                <path d="M12 17v5" />
                                <path
                                    d="M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z" />
                            </svg> Pinned Cards</a>
                    </li>
                    <li>
                        <a href="/folder"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-folder-icon lucide-folder">
                                <path
                                    d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                            </svg> Folders</a>
                    </li>
                    <li>
                        <a href="/settings"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-cog-icon lucide-cog">
                                <path d="M11 10.27 7 3.34" />
                                <path d="m11 13.73-4 6.93" />
                                <path d="M12 22v-2" />
                                <path d="M12 2v2" />
                                <path d="M14 12h8" />
                                <path d="m17 20.66-1-1.73" />
                                <path d="m17 3.34-1 1.73" />
                                <path d="M2 12h2" />
                                <path d="m20.66 17-1.73-1" />
                                <path d="m20.66 7-1.73 1" />
                                <path d="m3.34 17 1.73-1" />
                                <path d="m3.34 7 1.73 1" />
                                <circle cx="12" cy="12" r="2" />
                                <circle cx="12" cy="12" r="8" />
                            </svg> Settings</a>
                    </li>
                    <li>
                        <a href="/logout" style="color: red;"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                                height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round"
                                class="lucide lucide-log-out-icon lucide-log-out">
                                <path d="m16 17 5-5-5-5" />
                                <path d="M21 12H9" />
                                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                            </svg> Logout</a>
                    </li>
                </ul>
                <hr>
                <div class="page_titlea" style="font-size: smaller; color: var(--color); margin-block: 10px;">
                    Theme Select
                </div>
                <div class="theme">
                    <label for="dark" tabindex="0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-moon-icon lucide-moon">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                        </svg>
                        <input type="radio" name="theme" id="dark" value="dark" />
                    </label>
                    <label for="light" tabindex="0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-sun-icon lucide-sun">
                            <circle cx="12" cy="12" r="4" />
                            <path d="M12 2v2" />
                            <path d="M12 20v2" />
                            <path d="m4.93 4.93 1.41 1.41" />
                            <path d="m17.66 17.66 1.41 1.41" />
                            <path d="M2 12h2" />
                            <path d="M20 12h2" />
                            <path d="m6.34 17.66-1.41 1.41" />
                            <path d="m19.07 4.93-1.41 1.41" />
                        </svg>
                        <input type="radio" name="theme" id="light" value="light">
                    </label>
                    <label for="default" tabindex="0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-monitor-cog-icon lucide-monitor-cog">
                            <path d="M12 17v4" />
                            <path d="m14.305 7.53.923-.382" />
                            <path d="m15.228 4.852-.923-.383" />
                            <path d="m16.852 3.228-.383-.924" />
                            <path d="m16.852 8.772-.383.923" />
                            <path d="m19.148 3.228.383-.924" />
                            <path d="m19.53 9.696-.382-.924" />
                            <path d="m20.772 4.852.924-.383" />
                            <path d="m20.772 7.148.924.383" />
                            <path d="M22 13v2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7" />
                            <path d="M8 21h8" />
                            <circle cx="18" cy="6" r="3" />
                        </svg>
                        <input type="radio" name="theme" id="default" value="auto">
                    </label>
                </div>
            </div>
        </div>
    </nav>
    <div class="openList" style="display: none" onclick="toggleMenu()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-list-filter-icon lucide-list-filter">
            <path d="M3 6h18" />
            <path d="M7 12h10" />
            <path d="M10 18h4" />
        </svg>
    </div>
    <div class="advanced-search">
        <h3>Advanced Search</h3>
        <div class="feildList">
            <label for="title">
                <span>Title:</span>
                <input type="text" name="title" id="title" placeholder="Title" />
            </label>
            <!-- <label for="code"><span>Code:</span> <input type="text" name="code" id="code" placeholder="Code"></label> -->
            <label for="description">
                <span>Description:</span>
                <textarea type="text" name="description" id="description" placeholder="Description" rows="5"></textarea>
            </label>
            <label for="language">
                <span>Language:</span>
                <input type="text" name="language" id="language" placeholder="Language" list="languages" />
                <datalist id="languages">
                    <option value="JavaScript">JavaScript</option>
                    <option value="CSS">CSS</option>
                    <option value="HTML">HTML</option>
                    <option value="C">C</option>
                    <option value="C++">C++</option>
                    <option value="C#">C#</option>
                    <option value="Java">Java</option>
                    <option value="TypeScript">TypeScript</option>
                    <option value="Python">Python</option>
                    <option value="Ruby">Ruby</option>
                    <option value="PHP">PHP</option>
                    <option value="Go">Go</option>
                    <option value="Rust">Rust</option>
                    <option value="Swift">Swift</option>
                    <option value="Kotlin">Kotlin</option>
                    <option value="Objective-C">Objective-C</option>
                    <option value="Scala">Scala</option>
                    <option value="Perl">Perl</option>
                    <option value="R">R</option>
                    <option value="Dart">Dart</option>
                    <option value="Haskell">Haskell</option>
                    <option value="Lua">Lua</option>
                    <option value="Elixir">Elixir</option>
                    <option value="Clojure">Clojure</option>
                    <option value="Shell">Shell (Bash)</option>
                    <option value="PowerShell">PowerShell</option>
                    <option value="SQL">SQL</option>
                    <option value="GraphQL">GraphQL</option>
                    <option value="MATLAB">MATLAB</option>
                    <option value="Assembly">Assembly</option>
                    <option value="Fortran">Fortran</option>
                    <option value="COBOL">COBOL</option>
                    <option value="Erlang">Erlang</option>
                    <option value="VB.NET">VB.NET</option>
                </datalist>
            </label>
            <label for="folder">
                <span>Folder:</span>
                <input type="text" name="folder" id="folder" placeholder="Folder" />
            </label>
            <label for="date">
                <span>Date:</span>
                <input type="date" name="date" id="date" placeholder="Date" />
            </label>
        </div>
        <button id="searchBtn" onclick="advance_search()">Search</button>

    </div>

</header>

<div class="notification-bar">
    <h3>Notifications</h3>
    <ul class="notification-lists">
    </ul>
</div>



<script type="module">
    import { tooltip } from "/scripts/tooltip.js";
    ["#filter", ".notification", ".help", ".profile", ".music"].forEach(e => {
        tooltip(e);
    })

    function isReallyFullscreen() {
        return (
            document.fullscreenElement ||
            window.innerHeight === screen.height
        );
    }
    isReallyFullscreen() && window.location.pathname !== "/" ? document.querySelector(".backButton").style.display = "flex" : document.querySelector(".backButton").style.display = "none";
    window.addEventListener("resize", (e) => {
        isReallyFullscreen() && window.location.pathname !== "/" ? document.querySelector(".backButton").style.display = "flex" : document.querySelector(".backButton").style.display = "none";
    });


    let svg = document.querySelector(".music");
    let audio = document.getElementById("audio");
    document.querySelector(".music").addEventListener("click", () => {
        if (audio.paused) {
            audio.play();
        } else {
            audio.pause();
        }
    })
    audio.addEventListener("playing", () => {
        svg.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="animated" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-disc3-icon lucide-disc-3"><circle cx="12" cy="12" r="10"/><path d="M6 12c0-1.7.7-3.2 1.8-4.2"/><circle cx="12" cy="12" r="2"/><path d="M18 12c0 1.7-.7 3.2-1.8 4.2"/></svg>`
    })
    audio.addEventListener("pause", () => {
        svg.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg"  width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-music-icon lucide-music"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>`
    })
</script>

<script>
    function openProfile(e) {
        e.stopPropagation();
        document.querySelector(".profile-bar").classList.toggle("active");
    }
    let profile_bar = document.querySelector(".profile-bar");
    profile_bar.addEventListener("click", (e) => {
        e.stopPropagation();
    })
    window.addEventListener("click", (e) => {
        if (e.target !== profile_bar) {
            profile_bar.classList.remove("active");
        }
    })
</script>

<script>
    const themes = document.querySelectorAll("input[name='theme']");

    function applyTheme(theme) {
        if (theme === "auto") {
            // Detect current system theme
            const systemTheme = getSystemTheme();
            document.body.setAttribute("data-theme", systemTheme);
        } else {
            document.body.setAttribute("data-theme", theme);
        }

        // Update checked radio
        const input = document.querySelector(`input[value="${theme}"]`);
        if (input) input.checked = true;

        // Store only user’s choice, not resolved system theme
        localStorage.setItem("theme", theme);
    }

    function getSystemTheme() {
        return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    }

    // Handle manual theme change
    themes.forEach((ele) => {
        ele.addEventListener("change", (e) => {
            if (e.target.checked) {
                const selected = e.target.value;
                applyTheme(selected);
            }
        });
    });

    // Apply saved or system theme on page load
    window.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme") || "auto";
        applyTheme(savedTheme);
    });

    // Respond to system theme change — only if auto mode is active
    window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (e) => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "auto") {
            applyTheme("auto");
        }
    });
</script>

<script>
    async function getUserDetails() {
        try {
            const res = await fetch("/a");
            const data = await res.json();
            return data;
        } catch (error) {
            throw error;
        }
    }

    getUserDetails().then((a) => {
        localStorage.setItem(
            "data",
            btoa(unescape(encodeURIComponent(JSON.stringify(a))))
        );
        let userImage = document.getElementById("userImage");
        userImage.src = a.userImage;
        let userName = document.getElementById("userName");
        userName.innerHTML = a.userName;
        let goodName = document.getElementById("goodName");
        goodName.innerHTML = a.goodName;

    });

</script>