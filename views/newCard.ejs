<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>New Card | Kodhra - Code Snippet Manager</title>
  <link rel="stylesheet" href="/style/css/partials/Header.css">
  <link rel="stylesheet" href="/style/css/ad_search.css">
  <link rel="stylesheet" href="/style/css/Notification.css">
  <link rel="stylesheet" href="/style/css/index.css">
  <link rel="stylesheet" href="/style/css/card.css">
  <link rel="stylesheet" href="/style/css/folder.css">
  <link rel="stylesheet" href="/style/css/createSnippet.css">
  <link rel="stylesheet" href="/style/css/loader.css">
  <script src="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@3.0.0/dist/toaster.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@3.0.0/dist/toaster.min.css">

  <script src="/socket.io/socket.io.js"></script>

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/assets/logo.webp" type="image/png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.14/theme/eclipse.min.css">

  <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
  <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js">
  </script>
  <!-- Core language dependencies -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>

  <!-- HTML -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>

  <!-- C-family -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js"></script>

  <!-- Other languages -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/php/php.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/ruby/ruby.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/go/go.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/rust/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/swift/swift.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/sql/sql.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/shell/shell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/powershell/powershell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/yaml/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/perl/perl.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/r/r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/haskell/haskell.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/lua/lua.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/erlang/erlang.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/dart/dart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clojure/clojure.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/matlab/matlab.min.js"></script>
  <!-- Core autocomplete engine -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/show-hint.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/show-hint.min.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/javascript-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/html-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/css-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/sql-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/hint/anyword-hint.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/eclipse.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/ayu-dark.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/addon/mode/simple.min.js">
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/monokai.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/solarized.min.css" />

<style>
  .CodeMirror {
  min-height: 100px;
  width: 100%;
}
</style>
</head>

<body data-theme="light">
  <%- include("partials/loader.ejs") %>
    <div class="content">
      <%- include("partials/header")%>
        <div class="container">
          <%- include("partials/sidebar", {navigation: 'card-create' })%>
            <main style="width: 100%;height: calc(100vh - 70px); position: relative;">

              <div class="snippet-editor">

                <header class="snippet-header">
                  <label for="title1">
                    <span
                      style="display: flex; justify-content: start; align-items: center; gap: 5px; font-size: 15px !important;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-file-code-icon lucide-file-code">
                        <path
                          d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z" />
                        <path d="M14 2v5a1 1 0 0 0 1 1h5" />
                        <path d="M10 12.5 8 15l2 2.5" />
                        <path d="m14 12.5 2 2.5-2 2.5" />
                      </svg>
                      Snippet Title
                    </span>
                    <input type="text" id="title1" placeholder="Snippet title…" class="snippet-title"
                      style="display: inline-block !important;" value="Untitled." />
                  </label>
                  <div class="snippet-actions">
                    <button onclick="submitData()"
                      style="background: var(--accent2);color: var(--color);width: 150px; border: none;">
                      Save Snippet
                    </button>
                    <button onclick="window.location.reload()"
                      style="--accent2:pink;--color:red; border: none !important;">Cancel</button>
                  </div>
                </header>

                <!-- 2. CODE EDITOR -->
                <section class="editor-section">
                  <div class="editor-toolbar">
                    <span class="editor-label"
                      style="font-weight: bold; display: flex; justify-content: start;align-items: center;gap: 5px;font-size: 15px;"><svg
                        xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-code-icon lucide-code">
                        <path d="m16 18 6-6-6-6" />
                        <path d="m8 6-6 6 6 6" />
                      </svg> Code Snippet </span>
                    <% const lang=(settings.defaultLanguage || '' ).trim(); %>
                      <div class="editor-tools">
                        <!-- <div class="add-readme" role="button">
                          <span style="font-size: small; color: blue;">add readme.md</span>
                        </div> -->
                        <select name="language" id="category" class="klas">
                          <option value="JavaScript" <%=lang==='JavaScript' ? 'selected' : '' %>>JavaScript</option>
                          <option value="CSS" <%=lang==='CSS' ? 'selected' : '' %>>CSS</option>
                          <option value="HTML" <%=lang==='HTML' ? 'selected' : '' %>>HTML</option>
                          <option value="C" <%=lang==='C' ? 'selected' : '' %>>C</option>
                          <option value="C++" <%=lang==='C++' ? 'selected' : '' %>>C++</option>
                          <option value="C#" <%=lang==='C#' ? 'selected' : '' %>>C#</option>
                          <option value="Java" <%=lang==='Java' ? 'selected' : '' %>>Java</option>
                          <option value="TypeScript" <%=lang==='TypeScript' ? 'selected' : '' %>>TypeScript</option>
                          <option value="Python" <%=lang==='Python' ? 'selected' : '' %>>Python</option>
                          <option value="Ruby" <%=lang==='Ruby' ? 'selected' : '' %>>Ruby</option>
                          <option value="PHP" <%=lang==='PHP' ? 'selected' : '' %>>PHP</option>
                          <option value="Go" <%=lang==='Go' ? 'selected' : '' %>>Go</option>
                          <option value="Rust" <%=lang==='Rust' ? 'selected' : '' %>>Rust</option>
                          <option value="Swift" <%=lang==='Swift' ? 'selected' : '' %>>Swift</option>
                          <option value="Kotlin" <%=lang==='Kotlin' ? 'selected' : '' %>>Kotlin</option>
                          <option value="Objective-C" <%=lang==='Objective-C' ? 'selected' : '' %>>Objective-C</option>
                          <option value="Scala" <%=lang==='Scala' ? 'selected' : '' %>>Scala</option>
                          <option value="Perl" <%=lang==='Perl' ? 'selected' : '' %>>Perl</option>
                          <option value="R" <%=lang==='R' ? 'selected' : '' %>>R</option>
                          <option value="Dart" <%=lang==='Dart' ? 'selected' : '' %>>Dart</option>
                          <option value="Haskell" <%=lang==='Haskell' ? 'selected' : '' %>>Haskell</option>
                          <option value="Lua" <%=lang==='Lua' ? 'selected' : '' %>>Lua</option>
                          <option value="Elixir" <%=lang==='Elixir' ? 'selected' : '' %>>Elixir</option>
                          <option value="Clojure" <%=lang==='Clojure' ? 'selected' : '' %>>Clojure</option>
                          <option value="Shell" <%=lang==='Shell' ? 'selected' : '' %>>Shell (Bash)</option>
                          <option value="PowerShell" <%=lang==='PowerShell' ? 'selected' : '' %>>PowerShell</option>
                          <option value="SQL" <%=lang==='SQL' ? 'selected' : '' %>>SQL</option>
                          <option value="GraphQL" <%=lang==='GraphQL' ? 'selected' : '' %>>GraphQL</option>
                          <option value="MATLAB" <%=lang==='MATLAB' ? 'selected' : '' %>>MATLAB</option>
                          <option value="Assembly" <%=lang==='Assembly' ? 'selected' : '' %>>Assembly</option>
                          <option value="Fortran" <%=lang==='Fortran' ? 'selected' : '' %>>Fortran</option>
                          <option value="COBOL" <%=lang==='COBOL' ? 'selected' : '' %>>COBOL</option>
                          <option value="Erlang" <%=lang==='Erlang' ? 'selected' : '' %>>Erlang</option>
                          <option value="VB.NET" <%=lang==='VB.NET' ? 'selected' : '' %>>VB.NET</option>
                        </select>
                        <span onclick="requestFull()" class="maximize" id="maximize" style="cursor: pointer;">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-maximize-icon lucide-maximize">
                            <path d="M8 3H5a2 2 0 0 0-2 2v3" />
                            <path d="M21 8V5a2 2 0 0 0-2-2h-3" />
                            <path d="M3 16v3a2 2 0 0 0 2 2h3" />
                            <path d="M16 21h3a2 2 0 0 0 2-2v-3" />
                          </svg>
                        </span>
                      </div>
                  </div>

                  <textarea id="code" style="width: 100% !important;"></textarea>
                </section>

                <!-- 3. METADATA (SECONDARY) -->
                <section class="snippet-meta" style="margin-top: 20px !important;">

                  <div class="meta-field">
                    <label>
                      <span style="display: flex; justify-content: start;align-items: center;gap: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="lucide lucide-folder-icon lucide-folder">
                          <path
                            d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                        </svg>
                        Folder
                      </span>
                      <input type="text" id="folderName1" placeholder="Optional" />
                    </label>
                  </div>

                  <div class="meta-field">
                    <label>
                      <span style="display: flex; justify-content: start;align-items: center;gap: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="lucide lucide-tag-icon lucide-tag">
                          <path
                            d="M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z" />
                          <circle cx="7.5" cy="7.5" r=".5" fill="currentColor" />
                        </svg>
                        Tags
                      </span>
                      <input type="text" id="tags" placeholder="comma,separated,tags" />
                    </label>
                  </div>
                  <div class="meta-field">
                    <label>
                      <span style="display: flex; justify-content: start;align-items: center;gap: 10px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="lucide lucide-rss-icon lucide-rss">
                          <path d="M4 11a9 9 0 0 1 9 9" />
                          <path d="M4 4a16 16 0 0 1 16 16" />
                          <circle cx="5" cy="19" r="1" />
                        </svg>
                        Visibility
                      </span>
                      <select id="visibility">
                        <option value="true">Public</option>
                        <option value="false">Private</option>
                      </select>
                    </label>
                  </div>

                  <label class="meta-notes" style="display: block; width: 100% !important;">
                    <span style="display: flex; justify-content: start;align-items: center;gap: 10px;"><svg
                        xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-notebook-icon lucide-notebook">
                        <path d="M2 6h4" />
                        <path d="M2 10h4" />
                        <path d="M2 14h4" />
                        <path d="M2 18h4" />
                        <rect width="16" height="20" x="4" y="2" rx="2" />
                        <path d="M16 2v20" />
                      </svg> Description</span>
                    <textarea id="des" placeholder="Optional notes…" rows="5"></textarea>
                  </label>


                  <!-- Add Readme.md File Container  -->
                  <div class="readme-container">
                    <div class="readme-header">
                      <span class="title"
                        style="display: flex; justify-content: start;align-items: center; gap: 5px;font-weight: bolder;"><svg
                          xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="lucide lucide-book-open-icon lucide-book-open">
                          <path d="M12 7v14" />
                          <path
                            d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z" />
                        </svg> Add Readme.md File</span>
                    </div>

                    <!-- <hr style="margin-block:5px"> -->

                    <div class="readme-body">
                      <div class="meta-data"
                        style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: space-between;">
                        <label for="readme_title" id="readme_title">
                          <span
                            style="display: flex; align-items: center; gap: 5px; font-weight: 400 !important; font-size: small;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round" class="lucide lucide-notebook-pen-icon lucide-notebook-pen">
                              <path d="M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4" />
                              <path d="M2 6h4" />
                              <path d="M2 10h4" />
                              <path d="M2 14h4" />
                              <path d="M2 18h4" />
                              <path
                                d="M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z" />
                            </svg>Enter a title</span>
                          <input type="text" name="readme_title" id="readme_title1" placeholder="Title">
                        </label>
                        <label for="readme_desciption" id="readme_desciption" role="text">
                          <span
                            style="display: flex; align-items: center; gap: 5px; font-weight: 400 !important; font-size: small;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                              fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                              stroke-linejoin="round" class="lucide lucide-notebook-pen-icon lucide-notebook-pen">
                              <path d="M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4" />
                              <path d="M2 6h4" />
                              <path d="M2 10h4" />
                              <path d="M2 14h4" />
                              <path d="M2 18h4" />
                              <path
                                d="M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z" />
                            </svg>Enter a description</span>
                          <textarea type="text" name="readme_desciption" id="readme_desciption1"
                            placeholder="Description"></textarea>
                        </label>
                      </div>
                      <textarea id="asd">Write your Readme.md here</textarea>
                    </div>
                  </div>
                  <!--End of Add Readme.md File Container  -->

                  <span role="note" style="font-size: x-small; color: gray; line-height: 1.5; width: 80%;">
                    Note<sup style="color: red;">*</sup>: Upon saving, the code snippet will be recorded under the
                    active folder context.
                    Users are advised to confirm the selected folder before proceeding, as this determines how the
                    snippet will be
                    categorized and retrieved later.
                  </span>


                </section>
                <%- include("partials/fab.ejs")%>
              </div>

              <div class="loading" style="display: none">
                <span style="
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
                color: black;
                background: none;
              ">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-loader-circle-icon lucide-loader-circle">
                    <path d="M21 12a9 9 0 1 1-6.219-8.56" />
                  </svg>
                  Sending Data...</span>
              </div>

            </main>



            <div class="notification-bar">
              <h3>Notifications</h3>
              <ul class="notification-lists">
              </ul>
            </div>

        </div>
    </div>

    <script>
      const easyMDE = new EasyMDE({
        element: document.getElementById("asd"),
        toolbar: [
          "bold", "italic", "heading", "|",
          "quote", "unordered-list", "ordered-list", "|",
          "link", "image", "table", "|",
          "preview",
        ]
      });
    </script>

    <script>
      let editor;
      window.onload = async () => {
        const params = new URLSearchParams(window.location.search);
        const title = params.get("title") || "";
        const description = params.get("description") || "";
        const category = params.get("category") || "";
        const content = params.get("content") || "";
        const tags = params.get("tags") || "";
        const folderName = params.get("folderName") || "";

        const modeMap = {
          JavaScript: "javascript",
          C: "text/x-csrc",
          "C++": "text/x-c++src",
          "C#": "text/x-csharp",
          Java: "text/x-java",
          TypeScript: "text/typescript",
          Python: "python",
          Ruby: "ruby",
          PHP: "php",
          Go: "go",
          Rust: "rust",
          Swift: "swift",
          Kotlin: "text/x-kotlin",
          "Objective-C": "text/x-objectivec",
          Scala: "text/x-scala",
          Perl: "perl",
          R: "r",
          Dart: "dart",
          Haskell: "haskell",
          Lua: "lua",
          Elixir: "elixir",
          Clojure: "clojure",
          Shell: "shell",
          PowerShell: "powershell",
          SQL: "sql",
          GraphQL: "graphql",
          MATLAB: "octave",
          Assembly: "gas",
          Fortran: "fortran",
          COBOL: "cobol",
          Erlang: "erlang",
          "VB.NET": "vb",
          HTML: "htmlmixed",
          CSS: "css",
        };

        const lan = document.getElementById("category");

        const themeRadio = document.querySelector("input[name='theme']:checked");
        const currentTheme =
          themeRadio && themeRadio.value === "light" ? "eclipse" : "ayu-dark";

        editor = CodeMirror.fromTextArea(document.getElementById("code"), {
          lineNumbers: true,
          mode: modeMap[lan?.value] || "javascript",
          lineWrapping: true,
          theme: currentTheme,
          
          extraKeys: {
            "Ctrl-Space": "autocomplete",
            "Ctrl-/": "toggleComment",
            "Tab": function (cm) {
              cm.replaceSelection("  ");
            }
          }
        });
        editor.setSize("100%", "100%")

        const titleEl = document.getElementById("title1");
        const desEl = document.getElementById("des");
        const catEl = document.getElementById("category");
        const tagEl = document.getElementById("tags");
        const folderEl = document.getElementById("folderName1");
        const visibility = document.getElementById("visibility");
        const readme_title = document.getElementById("readme_title1");
        const readme_desciption = document.getElementById("readme_desciption1");
        

        if (titleEl) titleEl.value = title;
        if (desEl) desEl.value = description;

        if (catEl && category) {
          catEl.value = category;
        }

        if (tagEl) tagEl.value = tags;
        if (folderEl) folderEl.value = folderName;

        editor.setValue(content);

        if (lan) {
          lan.addEventListener("change", function () {
            const newMode = modeMap[this.value] || "javascript";
            editor.setOption("mode", newMode);
          });
        }

        document.querySelectorAll("input[name='theme']").forEach((inp) => {
          inp.addEventListener("change", () => {
            const newTheme = inp.value === "light" ? "eclipse" : "ayu-dark";
            editor.setOption("theme", newTheme);
            localStorage.setItem("theme", inp.value);
          });
        });

        window.submitData = async function () {
          const title = titleEl?.value || "";
          const description = desEl?.value || "";
          const category = catEl?.value || "";
          const content = editor.getValue() || "";
          const folderName = folderEl?.value || "";
          const visibility = document.getElementById("visibility")?.value || "";
          const readmefile = {
            title: readme_title?.value || "",
            description: readme_desciption?.value || "",
            content: easyMDE.value() || ""
          }
          const tags = (tagEl?.value || "")
            .split(",")
            .map((tag) => tag.trim())
            .filter(Boolean);

          try {
            const startTime = performance.now();
            const res = await fetch("/card", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              credentials: "include",
              body: JSON.stringify({ title, description, category, content, tags, folderName, visibility, readmefile }),
            });
            const data = await res.json();
            const duration = ((performance.now() - startTime) / 1000).toFixed(2);
            if (res.ok) {
              new Toastmaster({
                title: "Success",
                message: `Snippet created in just ${duration}s`,
                delay: 3000,
                type: "success"
              }).showNotification();
            } else {
              new Toastmaster({
                title: "Error",
                message: `Snippet Not Created!`,
                delay: 3000,
                type: "error"
              }).showNotification()
            }
          } catch (err) {
            console.error("Error submitting data:", err);
            if (loader) {
              new Toastmaster({
                title: "Error",
                message: `Snippet Not Created!`,
                delay: 3000,
                type: "error"
              }).showNotification()
            }
          }
        };
        await getEditorSettings();
      };



      async function getEditorSettings() {
        const res = await fetch("/settings/list", {
          method: "GET",
          credentials: "include",
          headers: {
            "content-Type": "application/json"
          }
        })
        if (res.ok) {
          const data = await res.json();
          const tabSizee = data.tabSize;
          const wordWrapp = data.wordWrap == "off" ? false : true;
          const lineNumber = data.lineNumbers == "on" ? true : false;
          const themes = data.syntaxStyle;
          editor.setOption("tabSize", tabSizee);
          editor.setOption("lineWrapping", wordWrapp);
          editor.setOption("lineNumbers", lineNumber);
          editor.setOption("theme", themes);
        }
      }
    </script>



    <script>
      // if ("serviceWorker" in navigator) {
      //     navigator.serviceWorker
      //       .register("/service-worker.js")
      //       .then((e) => console.log(`Service Worker registered ${e.installing}`))
      //       .catch((err) => console.error("SW registration failed:", err));
      //   }
    </script>

    <script>
      const labelOfCode = document.querySelector("label[for='code']");
      function requestFull() {
        if (document.fullscreenElement) {
          document.exitFullscreen();
        } else {
          document.querySelector(".CodeMirror").classList.toggle("active");
          document.querySelector(".snippet-editor").requestFullscreen();
        }
      }
      window.addEventListener("fullscreenchange", () => {
        if (document.fullscreenElement) {
          document.querySelector(".CodeMirror").classList.add("active");
        } else {
          document.querySelector(".CodeMirror").classList.remove("active")
        }
      });
    </script>



    <script src="\scripts\shortcut.js"></script>
    <script src="/scripts/home.js"></script>
    <script src="\scripts\index.js"></script>
    <script src="\scripts\Notification.js"></script>
    <script src="\scripts\ad_search.js"></script>
    <script src="\scripts\header.js"></script>
    <script src="\scripts\searchFunction.js"></script>
    <script src="\scripts\saveDraft.js"></script>
    <!-- <script src="\scripts\context_menu.js"></script> -->

    <script>

    </script>

</body>

</html>