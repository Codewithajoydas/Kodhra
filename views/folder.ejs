<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Folders | Kodhra - Code Snippet Manager</title>
  <meta name="title" content="Folders | Kodhra - Code Snippet Manager">
  <meta name="description"
    content="Organize, browse, and manage your code snippets effortlessly with Kodhra. Create folders, streamline your workflow, and keep all your development resources neatly structured.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://kodhra.codewithajoydas.live/folder">
  <meta property="og:title" content="Folders | Kodhra - Code Snippet Manager">
  <meta property="og:description"
    content="Organize, browse, and manage your code snippets effortlessly with Kodhra. Create folders, streamline your workflow, and keep all your development resources neatly structured.">
  <meta property="og:image" content="https://kodhra.codewithajoydas.live/icons/icon-512.png">
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://kodhra.codewithajoydas.live/folder">
  <meta property="twitter:title" content="Folders | Kodhra - Code Snippet Manager">
  <meta property="twitter:description"
    content="Organize, browse, and manage your code snippets effortlessly with Kodhra. Create folders, streamline your workflow, and keep all your development resources neatly structured.">
  <meta property="twitter:image" content="https://kodhra.codewithajoydas.live/icons/icon-512.png">
  <meta name="keywords"
    content="code snippets, developer snippets, programming snippets, HTML CSS JavaScript snippets, code snippet library, snippet collection, all code snippets, reusable code snippets, frontend code snippets, backend code snippets, JavaScript code examples, CSS tricks and snippets, HTML code examples, Node.js snippets, web development snippets, coding solutions, developer tools library, coding helper snippets, UI components snippets, reusable UI code, share code snippets, community code sharing, developer social platform, snippet likes and comments, open code library, public developer snippets, collaborative coding platform, best code snippet library for developers, quick copy-paste code examples, ready-to-use JavaScript snippets, helpful HTML CSS snippets for UI, community-driven coding resources, reusable coding patterns and utilities, coding inspiration for beginners and experts">
  <meta name="robots" content="index, follow">
  <meta http-equiv="Content-Type" content="text/html; charset=">
  <meta name="revisit-after" content="3 Days days">
  <meta name="author" content="Ajoy Das">
  <link rel="stylesheet" href="/style/css/partials/Header.css">
  <link rel="stylesheet" href="/style/css/ad_search.css">
  <link rel="stylesheet" href="/style/css/Notification.css">
  <link rel="stylesheet" href="/style/css/index.css">
  <link rel="stylesheet" href="/style/css/chip.css">
  <link rel="stylesheet" href="/style/css/card.css">
  <link rel="stylesheet" href="/style/css/loader.css">
  <link rel="stylesheet" href="/style/css/toast.css">
  <link rel="stylesheet" href="/style/css/folder.css">
  <link rel="stylesheet" href="/style/css/toast.css">
  <script src="\scripts\shortcut.js"></script>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/assets/logo.webp" type="image/png" />
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@3.0.0/dist/toaster.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@3.0.0/dist/toaster.min.css">



</head>

<body data-theme="light">
  <%- include("partials/loader.ejs") %>

    <div class="content">
      <%- include("partials/header.ejs")%>
        <div class="container">
          <%- include("partials/sidebar.ejs", {navigation: 'folder' })%>
            <main style="height: calc(100vh - 70px );">
              <div onclick="collapse(this)" class="cardContainer-header"
                style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                  <div class="page_title">
                    <span class="down"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" class="lucide lucide-chevron-down-icon lucide-chevron-down">
                        <path d="m6 9 6 6 6-6" />
                      </svg></span>
                    Folder Section
                  </div>
                </div>
                <div class="card-options disabled">
                  <div class="cardLen">125</div>
                  <div class="selectAll" onclick="selectAllButton(event)"><svg xmlns="http://www.w3.org/2000/svg"
                      width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-grid2x2-check-icon lucide-grid-2x2-check">
                      <path
                        d="M12 3v17a1 1 0 0 1-1 1H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6a1 1 0 0 1-1 1H3" />
                      <path d="m16 19 2 2 4-4" />
                    </svg></div>
                  <div class="deleteAll" onclick="deleteCards(event)"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                      height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-icon lucide-trash">
                      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6" />
                      <path d="M3 6h18" />
                      <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                    </svg></div>

                  <div class="download" onclick="downloadCard(event)"><svg xmlns="http://www.w3.org/2000/svg" width="24"
                      height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round"
                      class="lucide lucide-arrow-big-down-dash-icon lucide-arrow-big-down-dash">
                      <path
                        d="M15 11a1 1 0 0 0 1 1h2.939a1 1 0 0 1 .75 1.811l-6.835 6.836a1.207 1.207 0 0 1-1.707 0L4.31 13.81a1 1 0 0 1 .75-1.811H8a1 1 0 0 0 1-1V9a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1z" />
                      <path d="M9 4h6" />
                    </svg></div>
                </div>
              </div>
              <div class="foldersDiv" style="justify-content: center;">
                <% folders.forEach((folder, i)=> { %>
                  <div class="folder" data-name="<%= folder.folderName %>" data-id="<%= folder._id %>"
                    data-createat="<%= folder.createdAt %>" data-updateat="<%= folder.updatedAt %>"
                    data-menus="delete, rename, move, share" data-cardauthor="<%= folder.author._id %>"
                    data-userId="<%= userId %>" data-mtype="folder" data-cardname="<%= folder.folderName %>"
                    data-contextMenu="true" data-url="/folder/<%= folder._id %>"
                    ondblclick="window.open('/folder/<%= folder._id %>', '_blank')"
                    data-items="<%= folder.cards.length %>" tabindex="0">
                    <label for="select-<%= folder._id%>" class="checkbox" data-id="<%= folder._id %>">
                      <div class="folder_icon">
                        <% if (folder.cards.length>= 1) { %>
                          <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"
                            fill="#F7B31B" stroke="currentColor" stroke-width=".1" stroke-linecap="round"
                            stroke-linejoin="round" class="lucide lucide-folder-icon lucide-folder">
                            <path
                              d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                          </svg>
                          <% } else { %>
                            <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 24 24"
                              fill="#F7B31B" stroke="currentColor" stroke-width=".1" stroke-linecap="round"
                              stroke-linejoin="round" class="lucide lucide-folder-open-icon lucide-folder-open">
                              <path
                                d="m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2" />
                            </svg>
                            <% } %>
                      </div>
                      <input type="checkbox" name="select-<%= folder._id%>" id="select-<%= folder._id%>" class="select"
                        hidden>
                    </label>
                    <div class="folder_name" style="text-align: center;">

                      <div style="
                    display: -webkit-box;
                    -webkit-line-clamp: 1;
                    -webkit-box-orient: vertical;
                    overflow: hidden;
                    text-overflow: ellipsis;
                    max-width: 200px; 
                  ">
                        <%= folder.folderName %>
                      </div>
                      <span style="font-size: small; color: gray;">
                        Item Count <%= folder.cards.length %>
                      </span>
                    </div>
                  </div>
                  <%})%>
              </div>

              <div class="folder_info details-pane" aria-label="Folder details"
                style="width: 320px; padding: 16px; box-shadow: 0 0 0 1px rgba(0,0,0,0.04); background: var(--accent, #fff);">
                <div class="pane-header"
                  style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;">
                  <div style="display:flex;align-items:center;gap:10px;">
                    <div class="folder_icon" style="width:48px;height:48px;flex:0 0 48px;">
                      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="#F7B31B"
                        stroke="currentColor" stroke-width=".1" stroke-linecap="round" stroke-linejoin="round"
                        class="lucide lucide-folder-icon lucide-folder">
                        <path
                          d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                      </svg>
                    </div>
                    <div>
                      <div class="folder_title" style="font-weight:700;line-height:1;" title="Folder Name">
                        <span id="details-name">Folder Name</span>
                      </div>
                      <div style="font-size:12px;color:gray;margin-top:4px;" id="details-location">/path/to/folder</div>
                    </div>
                  </div>
                </div>
                <section class="pane-body" style="gap:14px;">
                  <div class="preview"
                    style="display:flex;flex-direction:column;align-items:center;margin-bottom: 15px;">
                    <!-- <img id="details-thumb" src="/assets/fillFolder.png" alt="Folder preview" width="80" height="80"> -->
                    <svg id="details-thumb" xmlns="http://www.w3.org/2000/svg" width="70" height="70"
                      viewBox="0 0 24 24" fill="#F7B31B" stroke="currentColor" stroke-width=".1" stroke-linecap="round"
                      stroke-linejoin="round" class="lucide lucide-folder-icon lucide-folder">
                      <path
                        d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z" />
                    </svg>

                    <small style="color:gray;text-align:center;" id="details-items">0 items â€¢ 0 KB</small>
                  </div>
                  <div class="meta" style="flex:1;">
                    <dl
                      style="display:grid;grid-template-columns:110px 1fr;row-gap:8px;column-gap:12px;font-size:13px;color:#111;">
                      <dt style="color:gray;font-weight:600;">Type</dt>
                      <dd id="details-type" style="margin:0; color:var(--color);">Folder</dd>
                      <dt style="color:gray;font-weight:600;">Location</dt>
                      <dd id="details-path"
                        style="margin:0; color:var(--color);;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">
                        /path/to/folder</dd>
                      <dt style="color:gray;font-weight:600;">Items</dt>
                      <dd id="details-count" style="margin:0; color:var(--color);">0</dd>
                      <dt style="color:gray;font-weight:600;">Size</dt>
                      <dd id="details-size" style="margin:0; color:var(--color);">0 KB</dd>
                      <dt style="color:gray;font-weight:600;">Created</dt>
                      <dd id="details-created" style="margin:0; color:var(--color);">â€”</dd>
                      <dt style="color:gray;font-weight:600;">Modified</dt>
                      <dd id="details-modified" style="margin:0; color:var(--color);">â€”</dd>
                    </dl>
                  </div>
                </section>

                <footer
                  style="margin-top:12px;border-top:1px solid rgba(0,0,0,0.04);padding-top:10px;display:flex;gap:8px;align-items:center;">
                  <small style="color:gray;">Quick actions:</small>
                  <button class="btn" onclick="newFileInFolder()" style="padding:6px 8px;" disabled>New File</button>
                  <button class="btn" onclick="addTag()" style="padding:6px 8px;" disabled>Add Tag</button>
                </footer>
              </div>

              <%- include("partials/fab.ejs")%>
            </main>
            <div id="context_menu" style="
                                position: absolute;
                                top: 0;
                                left: 0;
                                display: none;
                                z-index: 1000000;
                                width: 200px;
                              ">
              <ul id="context_menu_list"></ul>
            </div>

            <div class="move_folder">
              <div class="header_title" style="font-weight: bolder">
                <div class="span">Move " folderName"</div>
              </div>
              <hr />
              <div class="folders_name">
                <ul>
                  <% if (folders.length===0) { %>
                    <span style="margin: 10px; color: red">No folder found</span>
                    <% } %>
                      <% folders.forEach((folder, i)=> { %>
                        <li>
                          <label>
                            <input type="radio" name="moveFolder" value="<%= folder._id %>" id="moveFolder<%= i %>" />
                            <div class="folder">
                              <div class="folder_icon">
                                <!-- SVG folder icon -->
                              </div>
                              <div class="folder_name" style="
                                                        display: flex;
                                                        justify-content: center;
                                                        align-items: center;
                                                        gap: 10px;
                                                      ">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                  fill="#EDCE44" stroke="none" stroke-width="2" stroke-linecap="round"
                                  stroke-linejoin="round" class="lucide lucide-folder-icon lucide-folder">
                                  <path
                                    d="m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2" />
                                </svg>
                                <span style="
                                                                display: block;
                                                                width: 120px;
                                                                white-space: nowrap;
                                                                overflow: hidden;
                                                                text-overflow: ellipsis;
                                                              " title="<%= folder.folderName %>">
                                  <%= folder.folderName %>
                                </span>
                              </div>
                            </div>
                          </label>
                        </li>
                        <% }) %>
                </ul>
                <button class="move_btn" onclick="moveIt()" <%=folders.length===0 ? "disabled" : "" %> > Move </button>
              </div>
            </div>



            <div class="networkInfo" style="display: none;">
              <span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="lucide lucide-info-icon lucide-info">
                  <circle cx="12" cy="12" r="10" />
                  <path d="M12 16v-4" />
                  <path d="M12 8h.01" />
                </svg></span>

              <span id="networkInfo"></span>
            </div>
        </div>
    </div>

    <!-- Page Loader Animation -->
    <script>
      window.onload = () => {
        document.querySelector(".loader").style.display = "none";
      };
    </script>
    <!-- Page Loader Animation End -->
    <script src="\scripts\ad_search.js"></script>
    <script src="\scripts\searchFunction.js"></script>
    <script src="\scripts\notification.js"></script>
    <script src="\scripts\fab.js"></script>
    <script src="\scripts\header.js"></script>
    <script src="\scripts\isonline.js"></script>
    <script src="\scripts\context_menu.js"></script>
    <script>

      const folders = document.querySelectorAll('.folder');

      folders.forEach((folder, index) => {
        folder.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowRight') {
            const next = folders[index + 1];
            if (next) {
              next.focus();
              next.scrollIntoView({ behavior: 'smooth', inline: 'center' });
            }
          }
          if (e.key === 'ArrowLeft') {
            const prev = folders[index - 1];
            if (prev) {
              prev.focus();
              prev.scrollIntoView({ behavior: 'smooth', inline: 'center' });
            }
          }
        });
      });
    </script>
    <script>
      const folder = document.querySelectorAll('.folder');
      const folder_info = document.querySelector(".folder_info");
      folder_info.style.display = "none";
      folder.forEach(ele => {
        ele.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            ele.click();
          }
        });
        ele.addEventListener('click', async (event) => {
          event.stopPropagation();
          let folderName = ele.getAttribute('data-name');
          let folderId = ele.getAttribute('data-id');
          let folderSize = ele.getAttribute('data-items');
          let folderUrl = ele.getAttribute('data-url');
          let createAt = ele.getAttribute('data-crateat');
          let updateAt = ele.getAttribute('data-updateat');
          let size = await getFolderSize(folderUrl);
          const units = ['B', 'KB', 'MB', 'GB', 'TB'];
          if (size === 0) return '0 B';
          const i = Math.floor(Math.log(size) / Math.log(1024));
          let finalSize = (size / Math.pow(1024, i)).toFixed(2) + ' ' + units[i];
          const details_size = document.getElementById("details-size");
          details_size.textContent = finalSize;
          let details_name = document.getElementById("details-name");
          let details_path = document.getElementById("details-path");
          let details_items = document.getElementById("details-items");
          let details_count = document.getElementById("details-count");
          let details_location = document.getElementById("details-location");
          let details_created = document.getElementById("details-created");
          let details_modified = document.getElementById("details-modified");
          details_created.textContent = new Date(createAt).toLocaleString();
          details_modified.textContent = new Date(updateAt).toLocaleString();
          details_items.textContent = `${folderSize} â€¢ ${finalSize}`;
          details_count.textContent = folderSize;
          details_name.textContent = folderName;
          details_path.innerHTML = `<a href="/folder/${folderId}">/folder/${folderId}</a>`;
          details_location.innerHTML = `<a href="/folder/${folderId}">/folder/${folderId}</a>`;
          folder_info.style.display = "block";
        })
      })

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          folder_info.style.display = "none";
        }
      });
      document.addEventListener('click', (e) => {
        if (!folder_info.contains(e.target)) {
          folder_info.style.display = "none";
        }
      });

      async function getFolderSize(url) {
        const res = await fetch(url, {
          method: "HEAD",
          credentials: "include",
        });
        const size = res.headers.get("Content-Length");
        return size;
      }

    </script>


    <script src="/scripts/header.js"></script>
    <script src="\scripts\collapse.js"></script>

    <script>
      const containera = document.querySelector(".foldersDiv");
      containera.addEventListener("change", () => {
        updateSelectedCards();
      });

      const onDocumentChange = (mutationsList, observer) => {
        for (const mutation of mutationsList) {
          if (mutation.type === 'childList') {
          } else if (mutation.type === 'attributes') {
          }
        }
      };

      const config = {
        attributes: true,
        childList: true,
        subtree: true
      };

      const observers = new MutationObserver(onDocumentChange);

      if (containera) {
        observers.observe(containera, config);
      }
      let selectedCardsSet = new Set();




      function updateSelectedCards() {
        const selectedcards = document.querySelectorAll(".select");
        selectedcards.forEach(e => {
          const id = e.closest("[data-id]").dataset.id;
          if (e.checked) {
            selectedCardsSet.add(id);
          } else {
            selectedCardsSet.delete(id);
          }
        });
        let cardlen = document.querySelector(".cardLen");
        cardlen.textContent = [...selectedCardsSet].length
        if ([...selectedCardsSet].length > 0) {
          document.querySelector(".card-options").classList.remove("disabled");
        } else {
          document.querySelector(".card-options").classList.add("disabled");
        }
      }
      updateSelectedCards();


      function selectAllButton(event) {
        event.stopPropagation();
        const selectedcards = document.querySelectorAll(".select");
        const shouldSelect = !Array.from(selectedcards).every(cb => cb.checked);

        selectedcards.forEach(cb => cb.checked = shouldSelect);
        updateSelectedCards();
      }

      async function deleteCards(event) {
        event.stopPropagation();

        if (selectedCardsSet.size > 0) {
          try {
            const res = await fetch("/folder/delete", {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify({
                selected: [...selectedCardsSet]
              })
            });
            if (res.ok) {
              location.reload();
            }
          } catch (error) {
            console.error("Error deleting cards:", error);
            showToast("ðŸš¨ Unexpected error. Please check your connection.", "error");
          }
        } else {
          showToast("âš ï¸ Please select cards before deleting.", "error");
        }
      }

      async function downloadCard() {
        try {
          if (selectedCardsSet.size > 1) {
            const res = await fetch("/card/download", {
              method: "POST",
              headers: {
                "Content-Type": "application/json"
              },
              body: JSON.stringify({
                selected: [...selectedCardsSet]
              })
            });
            if (res.ok) {
              let data = await res.json();
              const blob = new Blob([JSON.stringify({ ...data })], { type: "application/json" });
              const url = URL.createObjectURL(blob);
              const a = document.createElement("a");
              a.href = url;
              const date = new Date().toLocaleDateString();
              const time = new Date().toLocaleTimeString();
              a.download = `Snippets-${date}-${time}.json`;
              a.click();
              URL.revokeObjectURL(url);
            } else {
              console.error("Somthing went wrong...")
              new Toastmaster({
                title: "Error",
                message: "âš ï¸ Something went wrong. Please try again.",
                type: "error",
                delay: 3000
              }).showNotification();
            }
          } else {
            new Toastmaster({
              title: "Error",
              message: "âš ï¸ Please select minimum 2 cards before downloading.",
              type: "error",
              delay: 3000
            }).showNotification();
          }
        } catch (error) {
          console.error(error.message);
        }
      }

      document.querySelectorAll(".folder_icon").forEach(e => {
        e.addEventListener("click", (e) => {
          e.stopPropagation();
        })
      })
    </script>
</body>

</html>