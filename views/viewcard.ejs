<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
        <%= card.title %> | Kodhra - Code Snippet Manager
    </title>
    <meta name="description" content="<%= (card.description || card.title).substring(0, 160) %>">
    <meta name="keywords" content="<%= (card.tags || []).join(', ') %>">
    <meta name="author" content="<%= card.author.userName %>">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://kodhra.codewithajoydas.live/card/<%= card._id %>">
    <meta property="og:type" content="article">
    <meta property="og:title" content="<%= card.title %>">
    <meta property="og:description" content="<%= (card.description || card.title).substring(0, 200) %>">
    <meta property="og:url" content="https://kodhra.codewithajoydas.live/card/<%= card._id %>">
    <meta property="og:site_name" content="Kodhra">
    <meta property="og:image"
        content="<%= card.author.userImage || 'https://kodhra.codewithajoydas.live/assets/logo.webp' %>">
    <meta property="og:image:alt" content="<%= card.title %>">
    <meta property="article:author" content="<%= card.author.userName %>">
    <meta property="article:published_time" content="<%= card.createdAt.toISOString() %>">
    <meta property="article:modified_time" content="<%= card.updatedAt.toISOString() %>">
    <meta property="article:section" content="<%= card.category %>">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= card.title %>">
    <meta name="twitter:description" content="<%= (card.description || card.title).substring(0, 200) %>">
    <meta name="twitter:image"
        content="<%= card.author.userImage || 'https://kodhra.codewithajoydas.live/assets/logo.webp' %>">
    <meta name="twitter:site" content="@codewithajoydas">
    <meta name="theme-color" content="#0f172a">


    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="/assets/logo.webp" type="image/png" />
    <link rel="stylesheet" href="/style/css/partials/Header.css">
    <link rel="stylesheet" href="/style/css/ad_search.css">
    <link rel="stylesheet" href="/style/css/Notification.css">
    <link rel="stylesheet" href="/style/css/index.css">
    <link rel="stylesheet" href="/style/css/chip.css">
    <link rel="stylesheet" href="/style/css/card.css">
    <link rel="stylesheet" href="/style/css/folder.css">
    <link rel="stylesheet" href="/style/css/loader.css">
    <link rel="stylesheet" href="/style/css/tags.css">
    <link rel="stylesheet" href="/style/css/viewcard.css">
    <script src="\scripts\shortcut.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@2.3.5/dist/toaster.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@codewithajoydas/toastmaster@2.3.5/dist/toaster.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
    <!-- Web -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/graphql/graphql.min.js"></script>

    <!-- C-family (C, C++, C#, Java, Kotlin, Scala, Objective-C) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js"></script>

    <!-- Backend / Scripting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/ruby/ruby.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/php/php.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/perl/perl.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/lua/lua.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/elixir/elixir.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/clojure/clojure.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/erlang/erlang.min.js"></script>

    <!-- System / DevOps -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/go/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/rust/rust.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/shell/shell.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/powershell/powershell.min.js"></script>

    <!-- Data / Scientific -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/sql/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/r/r.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/matlab/matlab.min.js"></script>

    <!-- Mobile / Modern -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/dart/dart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/swift/swift.min.js"></script>

    <!-- Low-level / Legacy -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/gas/gas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/fortran/fortran.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/cobol/cobol.min.js"></script>

    <!-- Microsoft -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/vb/vb.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/monokai.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/solarized.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        pre {
            background-color: var(--accent);
            padding: 2px 4px;
            border-radius: 4px;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 1rem 0;
        }

        hr {
            margin: 1rem 0;
        }

        p {
            margin: .2rem 0;
        }

        ul {
            padding-left: 1rem;
        }

        li {
            margin-left: 2rem;
            margin-block: .5rem;
            padding-left: .2rem;
        }
    </style>
    <style>
        .CodeMirror {
            min-height: 100px;
            width: 100%;
        }
    </style>
</head>

<body data-theme="light">
    <%- include('partials/loader.ejs')%>
        <div class="content">
            <%- include('partials/header')%>
                <div class="container">
                    <%- include('partials/sidebar', {navigation: 'card' })%>
                        <main style="height: calc(100vh - 70px);">

                            <div class="single-card"
                                style="background: var(--bg-color);padding: 10px;border-radius: 10px;">
                                <div class="card-header"
                                    style="display: flex; justify-content: space-between; align-items: center;">
                                    <div class="card-info" style="display: flex; gap: 10px; align-items: center;">
                                        <div class="avator">
                                            <img src="<%= card.author.userImage %>" alt="<%= card.author.userName%>"
                                                width="50">
                                        </div>
                                        <div class="name">
                                            <h2 style="margin: 0;">
                                                <%= card.title%>
                                            </h2>
                                            <div style=" font-size:small;color: gray; margin-top: 5px;display: flex;">
                                                <span
                                                    style="display: -webkit-box; line-clamp: 1; -webkit-line-clamp: 1; -webkit-box-orient: vertical; max-width: 500px;overflow: hidden;">
                                                    <%= card.description %>
                                                </span>, <span id="lan"
                                                    style="padding: 2px 10px; background: var(--accent2); border-radius: 5px; color: var(--color);">
                                                    <%= card.category%>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <style>
                                        .menu-top {
                                            display: flex;
                                            justify-content: center;
                                            align-items: center;
                                            width: 50px;
                                            height: 50px;
                                            border-radius: 50%;
                                            transition: all 0.25s;
                                        }

                                        .menu-top:hover {
                                            background: var(--accent);
                                            cursor: pointer;
                                        }
                                    </style>
                                    <div class="actions"
                                        style="display: flex; justify-content: start; align-items: center;gap: 10px;">
                                        <time datetime="<%= card.updatedAt%>"
                                            style="font-size: small; display: flex;justify-content: start;align-items: center;gap: 5px; white-space: nowrap;"><svg
                                                xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-calendar-clock-icon lucide-calendar-clock">
                                                <path d="M16 14v2.2l1.6 1" />
                                                <path d="M16 2v4" />
                                                <path
                                                    d="M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5" />
                                                <path d="M3 10h5" />
                                                <path d="M8 2v4" />
                                                <circle cx="16" cy="16" r="6" />
                                            </svg>
                                            <%= new Date(card.updatedAt).toLocaleString()%>
                                        </time>
                                        <button
                                            onclick="window.navigator.clipboard.writeText('<%= card.content%>');alert('ðŸŽ‰ Copied to clipboard!')">Copy</button>
                                        <div class="menu-top" data-menu-id="<%= card._id %>" data-id="<%= card._id %>"
                                            data-tooltip="Open Menu" data-menus="delete, edit, move, share"
                                            onclick="openContextMenu(event)" data-userId="<%= userId %>"
                                            data-cardauthor="<%= card.author._id %>" data-cardName="<%= card.title %>"
                                            data-mtype="card" data-contextMenu="true" tabindex="0">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-ellipsis-vertical-icon lucide-ellipsis-vertical">
                                                <circle cx="12" cy="12" r="1" />
                                                <circle cx="12" cy="5" r="1" />
                                                <circle cx="12" cy="19" r="1" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="page_title" onclick="collapse(this)"
                                        style="margin: 0 !important; padding: 0 !important; background: none !important; margin-top: 10px !important;">
                                        <span class="down"><svg xmlns="http://www.w3.org/2000/svg" width="20"
                                                height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-chevron-down-icon lucide-chevron-down">
                                                <path d="m6 9 6 6 6-6" />
                                            </svg></span>
                                        Code
                                    </div>
                                    <div class="card-content">
                                        <textarea name="codeMirrorViewer"
                                            id="codeMirrorViewer"><%= card.content%></textarea>
                                        <div class="options"
                                            style="margin-block:5px; display: flex; align-items: center;justify-content: space-between;">
                                            <div class="download">
                                                <button
                                                    style="background: var(--color);color: var(--bg-color); --accent2:var(--color)"
                                                    onclick="window.location.href = `/folders/download/<%= card._id%>`">Download
                                                    File</button>
                                            </div>

                                            <div class="sub_menu"
                                                style="display: flex; justify-content: end;align-items: center;gap: 10px;">
                                                <div class="gist_upload card" onclick="copy_cdn_link(event)"
                                                    data-tooltip="Copy CDN Link" data-id="<%= card._id%>">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                                        viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                        stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                        class="lucide lucide-link-icon lucide-link">
                                                        <path
                                                            d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                                                        <path
                                                            d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                                                    </svg>
                                                </div>
                                                <div class="pin" onclick="pinIt(this,'<%= card._id %>')"
                                                    data-tooltip="Pin" data-id="<%= card._id%>" tabindex="0">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                                        viewBox="0 0 24 24" class="<%= card.isPinned ? 'active' : '' %>"
                                                        fill="none" stroke="currentColor" stroke-width="2"
                                                        stroke-linecap="round" stroke-linejoin="round"
                                                        class="lucide lucide-pin-icon lucide-pin">
                                                        <path d="M12 17v5" />
                                                        <path
                                                            d="M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z" />
                                                    </svg>
                                                </div>
                                                <div style="
                                                                                                  display: flex;
                                                                                                  justify-content: center;
                                                                                                  align-items: center;
                                                                                                  gap: 4px;">
                                                    <span style="font-size: small" class="like-count"
                                                        id="like-count-<%= card._id%>">
                                                        <%= card.likes?.length || 0 %>
                                                    </span>

                                                    <div class="fav" data-tooltip="Favorite"
                                                        onclick="favIt(this, '<%= card._id %>')"
                                                        data-id="<%= card._id%>" tabindex="0">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                                            viewBox="0 0 24 24"
                                                            class="<%= card.isFavorite ? 'active' : '' %>" fill="none"
                                                            stroke="currentColor" stroke-width="2"
                                                            stroke-linecap="round" stroke-linejoin="round"
                                                            class="lucide lucide-star-icon lucide-star">
                                                            <path
                                                                d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z" />
                                                        </svg>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="readme-body">
                                    <div class="page_title" onclick="collapse(this)"
                                        style="margin: 0 !important; padding: 0 !important; background: none !important;">
                                        <span class="down"><svg xmlns="http://www.w3.org/2000/svg" width="20"
                                                height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-chevron-down-icon lucide-chevron-down">
                                                <path d="m6 9 6 6 6-6" />
                                            </svg></span>
                                        Documentation
                                    </div>
                                    <div id="readmefile" data-content="<%= card.readmefile.content%>"
                                        style="margin:10px;">
                                        <h2 style="margin: 0 !important; display: flex;align-items: center;gap: 5px;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="lucide lucide-book-open-icon lucide-book-open">
                                                <path d="M12 7v14" />
                                                <path
                                                    d="M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z" />
                                            </svg>
                                            <%= card.readmefile.title || 'No title' %>
                                        </h2>
                                    </div>
                                </div>
                            </div>
                        </main>


                        <div id="context_menu" style="
                                position: absolute;
                                top: 0;
                                left: 0;
                                display: none;
                                z-index: 1000000;
                                width: 200px;
                              ">
                            <ul id="context_menu_list"></ul>
                        </div>

                        <div class="networkInfo" style="display: none;">
                            <span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="lucide lucide-info-icon lucide-info">
                                    <circle cx="12" cy="12" r="10" />
                                    <path d="M12 16v-4" />
                                    <path d="M12 8h.01" />
                                </svg></span>

                            <span id="networkInfo"></span>
                        </div>
                        <div class="move_folder">
                            <div class="header_title" style="font-weight: bolder">
                                <div class="span">Move " folderName"</div>
                            </div>
                            <hr />
                            <div class="folders_name">
                                <ul>
                                    <% if (folders.length===0) { %>
                                        <span style="margin: 10px; color: red">No folder found</span>
                                        <% } %>
                                            <% folders.forEach((folder, i)=> { %>
                                                <li>
                                                    <label>
                                                        <input type="radio" name="moveFolder" value="<%= folder._id %>"
                                                            id="moveFolder<%= i %>" />
                                                        <div class="folder">
                                                            <div class="folder_icon">
                                                                <!-- SVG folder icon -->
                                                            </div>
                                                            <div class="folder_name" style="
                                            display: flex;
                                            justify-content: center;
                                            align-items: center;
                                            gap: 10px;
                                          ">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                    height="24" viewBox="0 0 24 24" fill="#EDCE44"
                                                                    stroke="none" stroke-width="2"
                                                                    stroke-linecap="round" stroke-linejoin="round"
                                                                    class="lucide lucide-folder-icon lucide-folder">
                                                                    <path
                                                                        d="m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2" />
                                                                </svg>
                                                                <span style="
                                              display: block;
                                              width: 120px;
                                              white-space: nowrap;
                                              overflow: hidden;
                                              text-overflow: ellipsis;
                                            " title="<%= folder.folderName %>">
                                                                    <%= folder.folderName %>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </label>
                                                </li>
                                                <% }) %>
                                </ul>
                                <button class="move_btn" onclick="moveIt()" <%=folders.length===0 ? "disabled" : "" %> >
                                    Move </button>
                            </div>
                        </div>
                </div>
        </div>




        <script>
            const languageModeMap = {
                JavaScript: "javascript",
                TypeScript: "javascript",
                HTML: "htmlmixed",
                CSS: "css",
                C: "text/x-csrc",
                "C++": "text/x-c++src",
                "C#": "text/x-csharp",
                Java: "text/x-java",
                Kotlin: "text/x-kotlin",
                Scala: "text/x-scala",
                "Objective-C": "text/x-objectivec",
                Python: "python",
                Ruby: "ruby",
                PHP: "php",
                Go: "go",
                Rust: "rust",
                Swift: "swift",
                Perl: "perl",
                R: "r",
                Dart: "dart",
                Haskell: "haskell",
                Lua: "lua",
                Elixir: "elixir",
                Clojure: "clojure",
                Shell: "shell",
                PowerShell: "powershell",
                SQL: "sql",
                GraphQL: "graphql",
                MATLAB: "matlab",
                Assembly: "gas",
                Fortran: "fortran",
                COBOL: "cobol",
                Erlang: "erlang",
                "VB.NET": "vb"
            };
            const lan = document.getElementById("lan");
            const finalLan = languageModeMap[lan.textContent.trim()] ?? lan.textContent.trim();
            const codeMirror = CodeMirror.fromTextArea(
                document.getElementById("codeMirrorViewer"),
                {
                    mode: finalLan,
                    readOnly: "nocursor",
                    lineNumbers: true,
                    lineWrapping: true,
                    viewportMargin: Infinity
                }
            );
            codeMirror.setSize("100%", "100%")
            async function getTheme() {
                const res = await fetch("/settings/list", {
                    method: "GET",
                    credentials: "include"
                });
                if (res.ok) {
                    try {
                        const data = await res.json();
                        const theme = data.syntaxStyle;
                        codeMirror.setOption("theme", theme);
                    } catch (error) {
                        console.log(error)
                    }
                }
            }
            getTheme()
        </script>
        <script>
            const markdown = document.getElementById("readmefile");
            const content = markdown.getAttribute("data-content");
            markdown.innerHTML += marked.parse(content);
        </script>
        <script src="/scripts/home.js"></script>
        <script src="/scripts/ad_search.js"></script>
        <script src="/scripts/Fab.js"></script>
        <script src="/scripts/Notification.js"></script>
        <script src="/scripts/searchFunction.js"></script>
        <script src="/scripts/context_menu.js"></script>
        <script src="/scripts/isonline.js"></script>
        <script src="/scripts/header.js"></script>
        <script src="/scripts/Tooltips.js"></script>
        <script src="/scripts/collapse.js"></script>


</body>

</html>